name: Run Auto-Doc on README.md
on:
  push:
    branches:
     - 0.x
     - 1.x
    paths:
      - 'action.yml'
permissions:
  contents: write
  pull-requests: write
jobs:
  update-docs:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v5

      - name: Run Auto-Doc
        uses: tj-actions/auto-doc@v3.6.0
        with:
          output: 'readme.md'

      - name: Verify changed files
        uses: tj-actions/verify-changed-files@v20.0.4
        id: verify-changed-files
        with:
            files: |
              readme.md

      - name: Create pull request
        if: steps.verify-changed-files.outputs.files_changed == 'true'
        uses: peter-evans/create-pull-request@v7.0.8
        with:
          token: ${{ secrets.GH_PAT }}
          base: "0.x"
          title: "[auto-doc] Update README.md"
          branch: "chore/auto-doc-update-readme"
          commit-message: "[auto-doc] Update README.md"
          body: "This pull request updates the documentation to the latest action.yml."